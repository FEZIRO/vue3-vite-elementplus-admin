var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,t=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o;import{u as i}from"./useTableData.9587872d.js";import{C as n,D as s,u as d,r,b as m,e as u,f as p,h as c,F as f,x as b,z as h,A as g,w,o as y,v as C,c as v,E as k,G as _,y as x}from"./vendor.9437a1ef.js";import{a as z}from"./index.db133084.js";import{h as V}from"./index.ffebf55c.js";const T=[{id:1,name:"普通人员"},{id:2,name:"管理员"}];z(T,{keyName:"id"});const M=[{id:1,name:"男"},{id:2,name:"女"}];z(M,{keyName:"id"});const S={name:"UserEdit",emits:["confirm"],setup(e,i){d();const n=r({type:"",title:"",visible:!1,confirmBtnLoading:!1}),s=r({form:{userName:"",sex:"",phone:"",role:""}}),m=()=>{n.visible=!1,s.form={userName:"",sex:"",phone:"",role:""}};return{modalConfig:n,data:s,sexOptions:M,roleOptions:T,hideModal:m,showModal:(e={type:"add",title:"",data:{}})=>{n.type=e.type,n.visible=!0,"add"===e.type&&(n.title="添加"),"edit"===e.type&&(n.title="编辑"),n.title=e.title||"",e.data&&(s.form=((e,i)=>{for(var n in i||(i={}))a.call(i,n)&&t(e,n,i[n]);if(l)for(var n of l(i))o.call(i,n)&&t(e,n,i[n]);return e})({},e.data))},onModalConfirmClick:()=>{m(),i.emit("confirm")},onModalCloseClick:()=>{m()}}}},E=h();n("data-v-4898c2bf");const O={class:"avatar-upload-wrap"},P=c("div",{class:"uploader-bottom"},[c("i",{class:"icon-upload el-icon-camera"})],-1),U=g("取 消"),j=g("确 定");s();const N=E(((e,l,a,o,t,i)=>{const n=m("el-avatar"),s=m("el-upload"),d=m("el-col"),r=m("el-input"),h=m("el-form-item"),g=m("el-option"),w=m("el-select"),y=m("el-row"),C=m("el-form"),v=m("el-button"),k=m("el-dialog");return u(),p(k,{title:o.modalConfig.title,modelValue:o.modalConfig.visible,"onUpdate:modelValue":l[5]||(l[5]=e=>o.modalConfig.visible=e),width:"40%","close-on-click-modal":!1},{footer:E((()=>[c(v,{onClick:o.onModalCloseClick,size:"medium"},{default:E((()=>[U])),_:1},8,["onClick"]),c(v,{type:"primary",onClick:o.onModalConfirmClick,size:"medium",loading:o.modalConfig.confirmBtnLoading},{default:E((()=>[j])),_:1},8,["onClick","loading"])])),default:E((()=>[c(C,{size:"medium",style:{"min-height":"200px"},"label-width":"100px","label-position":"top"},{default:E((()=>[c(y,{gutter:20},{default:E((()=>[c(d,{span:24},{default:E((()=>[c(s,{class:"avatar-uploader",action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1},{default:E((()=>[c("div",O,[c(n,{size:100,style:{"margin-bottom":"30px"},src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}),P])])),_:1})])),_:1}),c(d,{span:12},{default:E((()=>[c(h,{label:"用户名："},{default:E((()=>[c(r,{size:"medium",modelValue:o.data.form.userName,"onUpdate:modelValue":l[1]||(l[1]=e=>o.data.form.userName=e),placeholder:"请输入用户名",clearable:"",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),c(d,{span:12},{default:E((()=>[c(h,{label:"性别："},{default:E((()=>[c(w,{modelValue:o.data.form.sex,"onUpdate:modelValue":l[2]||(l[2]=e=>o.data.form.sex=e),placeholder:"请选择性别",clearable:"",size:"medium",style:{width:"100%"}},{default:E((()=>[(u(!0),p(f,null,b(o.sexOptions,(e=>(u(),p(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),c(d,{span:12},{default:E((()=>[c(h,{label:"联系电话："},{default:E((()=>[c(r,{modelValue:o.data.form.phone,"onUpdate:modelValue":l[3]||(l[3]=e=>o.data.form.phone=e),placeholder:"请输入联系电话",size:"medium",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),c(d,{span:12},{default:E((()=>[c(h,{label:"角色："},{default:E((()=>[c(w,{modelValue:o.data.form.role,"onUpdate:modelValue":l[4]||(l[4]=e=>o.data.form.role=e),placeholder:"请选择角色",size:"medium",style:{width:"100%"}},{default:E((()=>[(u(!0),p(f,null,b(o.roleOptions,(e=>(u(),p(g,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["title","modelValue"])}));S.render=N,S.__scopeId="data-v-4898c2bf";const D={name:"user-management",components:{UserEdit:S},setup(){const e=d(),l=i(V.userManagement.list);let a=r({keyword:"",sex:""});w([()=>a.keyword,()=>a.sex],(()=>{l.setParams({keyword:a.keyword,sex:a.sex})}));y((()=>{l.setParams({keyword:a.keyword})}));const o=C([]),t=C(null);return{filterForm:a,userManagementTable:l,tableSelection:o,userTableEdit:t,onTableAddClick:()=>{t.value.showModal({type:"add",title:"添加"})},onTableEditClick:e=>{t.value.showModal({type:"edit",title:"添加",data:{userName:e.userName,sex:e.sex,phone:e.phone,role:e.role}})},onTableDeleteClick:()=>{},onTableSelectionChange:e=>{o.value=e},onSizeChange:e=>{l.setParams({pageSize:e})},onCurrentChange:e=>{l.setParams({currentPage:e})},windowRect:v((()=>e.state.app.windowRect)),device:v((()=>e.state.app.device))}}},F=h();n("data-v-0e832da3");const A={class:"user-management-page","element-loading-text":"拼命加载中"},I=g("添加"),L=g("删除"),R=g("编辑"),B=g(" 暂无数据 "),G={class:"table-pager"};s();const H=F(((e,l,a,o,t,i)=>{const n=m("el-input"),s=m("el-option"),d=m("el-select"),r=m("el-button"),f=m("el-space"),b=m("el-table-column"),h=m("el-avatar"),w=m("el-tag"),y=m("el-table"),C=m("el-pagination"),v=m("UserEdit"),z=k("loading");return _((u(),p("div",A,[c(f,{wrap:"",style:{width:"100%"}},{default:F((()=>[c(n,{modelValue:o.filterForm.keyword,"onUpdate:modelValue":l[1]||(l[1]=e=>o.filterForm.keyword=e),class:"search-input","prefix-icon":"el-icon-search",size:"small",placeholder:"用户名/姓名",clearable:"",style:{width:"200px"}},null,8,["modelValue"]),c(d,{style:{width:"100px"},modelValue:o.filterForm.sex,"onUpdate:modelValue":l[2]||(l[2]=e=>o.filterForm.sex=e),class:"search-input","prefix-icon":"el-icon-search",size:"small",placeholder:"性别",clearable:""},{default:F((()=>[c(s,{label:"男",value:"1"}),c(s,{label:"女",value:"2"})])),_:1},8,["modelValue"]),c(r,{type:"primary",size:"small",icon:"el-icon-circle-plus-outline",onClick:o.onTableAddClick},{default:F((()=>[I])),_:1},8,["onClick"]),c(r,{type:"danger",size:"small",icon:"el-icon-delete",disabled:0==o.tableSelection.length,onClick:o.onTableDeleteClick},{default:F((()=>[L])),_:1},8,["disabled","onClick"])])),_:1}),c(y,{data:o.userManagementTable.tableData.list,"tooltip-effect":"dark",height:o.windowRect.clientHeight-240,"row-style":{height:"65px"},onSelectionChange:o.onTableSelectionChange},{empty:F((()=>[B])),default:F((()=>[c(b,{type:"selection",width:"50","show-overflow-tooltip":"","header-align":"center",align:"center"}),c(b,{label:"头像",width:"80","show-overflow-tooltip":""},{default:F((e=>[c(h,{size:32,src:e.row.img},null,8,["src"])])),_:1}),c(b,{prop:"userName",label:"用户名","show-overflow-tooltip":""}),c(b,{prop:"sex",label:"性别","show-overflow-tooltip":""}),c(b,{label:"角色","show-overflow-tooltip":""},{default:F((e=>[c(w,{effect:"dark",size:"small"},{default:F((()=>[g(x(e.row.role),1)])),_:2},1024)])),_:1}),c(b,{prop:"phone",label:"联系电话","min-width":"120","show-overflow-tooltip":""}),c(b,{prop:"loginTime",label:"登录次数","show-overflow-tooltip":""}),c(b,{prop:"lastLoginTime",label:"最后登录时间","min-width":"200","show-overflow-tooltip":""}),c(b,{label:"操作","show-overflow-tooltip":"","min-width":"95",fixed:"right"},{default:F((e=>[c(r,{type:"warning",size:"small",onClick:l=>o.onTableEditClick(e.row)},{default:F((()=>[R])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSelectionChange"]),c("div",G,[c(C,{onSizeChange:o.onSizeChange,onCurrentChange:o.onCurrentChange,"page-size":o.userManagementTable.tableParams.pageSize,"page-sizes":o.userManagementTable.PAGE_SIZES,layout:"total,prev,pager,next,"+("mobile"===o.device?"":"sizes"),total:o.userManagementTable.tableData.totalCount,small:"mobile"===o.device},null,8,["onSizeChange","onCurrentChange","page-size","page-sizes","layout","total","small"])]),c(v,{ref:"userTableEdit",onConfirm:o.userManagementTable.refresh},null,8,["onConfirm"])],512)),[[z,o.userManagementTable.tableData.isLoading]])}));D.render=H,D.__scopeId="data-v-0e832da3";export default D;
